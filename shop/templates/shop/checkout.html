{% extends 'shop/base.html' %}

{% block title %}Checkout - ShopHub{% endblock %}

{% block content %}
<div class="container py-4">

    <!-- HEADER -->
    <div class="mb-4">
        <h2 class="fw-bold">
            <i class="fas fa-lock text-success"></i> Secure Checkout
        </h2>
        <p class="text-muted">Complete your order securely</p>
    </div>

    <div class="row g-4">

        <!-- LEFT: FORM -->
        <div class="col-lg-8">

            <form method="POST" id="checkoutForm">
                {% csrf_token %}

                <!-- PERSONAL INFO -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-white fw-bold">
                        <i class="fas fa-user"></i> Personal Information
                    </div>
                    <div class="card-body">

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label>First Name</label>
                                {{ form.first_name }}
                            </div>
                            <div class="col-md-6">
                                <label>Last Name</label>
                                {{ form.last_name }}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <label>Email</label>
                                {{ form.email }}
                            </div>
                            <div class="col-md-6">
                                <label>Phone</label>
                                {{ form.phone }}
                            </div>
                        </div>

                    </div>
                </div>

                <!-- ADDRESS -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-white fw-bold">
                        <i class="fas fa-map-marker-alt"></i> Delivery Address
                    </div>
                    <div class="card-body">

                        <div class="mb-3">
                            <label>Full Address</label>
                            {{ form.address }}
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <label>City</label>
                                {{ form.city }}
                            </div>
                            <div class="col-md-4">
                                <label>State</label>
                                {{ form.state }}
                            </div>
                            <div class="col-md-4">
                                <label>Pincode</label>
                                {{ form.postal_code }}
                            </div>
                        </div>

                    </div>
                </div>

                <!-- PAYMENT -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-white fw-bold">
                        <i class="fas fa-credit-card"></i> Payment Method
                    </div>
                    <div class="card-body">
                        {{ form.payment_method }}
                        <div class="alert alert-success mt-3">
                            <i class="fas fa-truck"></i> Cash on Delivery — Pay when you receive.
                        </div>
                    </div>
                </div>

                <!-- ACTIONS -->
                <div class="d-flex justify-content-between">
                    <a href="{% url 'view_cart' %}" class="btn btn-outline-secondary">
                        ← Back to Cart
                    </a>
                    <button type="submit" class="btn btn-success btn-lg">
                        <i class="fas fa-check-circle"></i> Place Order
                    </button>
                </div>

            </form>

        </div>

        <!-- RIGHT: PRICE DETAILS -->
        <div class="col-lg-4">

            <div class="card shadow-sm">
                <div class="card-header bg-white fw-bold">
                    <i class="fas fa-file-invoice"></i> Price Details
                </div>

                <div class="card-body">

                    <!-- ITEMS -->
                    {% for item in cart_items %}
                        <div class="d-flex justify-content-between mb-2">
                            <div>
                                <strong>{{ item.product.name }}</strong><br>
                                <small class="text-muted">Qty: {{ item.quantity }}</small>
                            </div>
                            <div>₹{{ item.get_subtotal }}</div>
                        </div>
                        <hr>
                    {% endfor %}

                    <!-- TOTALS -->
                    <div class="d-flex justify-content-between">
                        <span>Price (Items)</span>
                        <span>₹{{ subtotal }}</span>
                    </div>

                    <div class="d-flex justify-content-between">
                        <span>GST (18%)</span>
                        <span>₹{{ tax }}</span>
                    </div>

                    <div class="d-flex justify-content-between">
                        <span>Delivery</span>
                        <span class="text-success">FREE</span>
                    </div>

                    <hr>

                    <div class="d-flex justify-content-between fw-bold fs-5 text-success">
                        <span>Total Amount</span>
                        <span>₹{{ grand_total }}</span>
                    </div>

                </div>
            </div>

        </div>

    </div>
</div>
{% endblock %}
